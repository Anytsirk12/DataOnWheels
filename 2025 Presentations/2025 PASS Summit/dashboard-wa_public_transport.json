{"$schema":"https://pbiadx.powerbi.com/static/d/schema/63/dashboard.json","id":"b5b5001b-4caf-4ddb-a89e-b6d24f302296","eTag":"\"4718be8740b4453080d382c348bda0e3\"","title":"wa_public_transport","schema_version":63,"autoRefresh":{"enabled":true,"defaultInterval":"5m","minInterval":"5m"},"tiles":[{"id":"1a396982-d79b-46a1-9831-12591fcfe368","title":"Number of records ingested by time","layout":{"x":4,"y":4,"width":12,"height":6},"pageId":"95dab4be-cb3c-4c31-8f70-b1751051a801","visualType":"timechart","queryRef":{"kind":"query","queryId":"0af8d177-b5ac-4944-b15f-b62231db3899"},"visualOptions":{"multipleYAxes":{"base":{"id":"d13c7aa2-c375-4f7f-a47d-388bdc853f2a","columns":[],"label":"","yAxisMinimumValue":null,"yAxisMaximumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"legendLocation":"bottom","crossFilter":[],"drillthrough":[],"selectedDataOnLoad":{"all":true,"limit":10},"dataPointsTooltip":{"all":false,"limit":1}}},{"id":"725b94e1-3d77-4691-8b38-180322ce3a6a","title":"public_transport - example dashboard","layout":{"x":0,"y":0,"width":16,"height":4},"pageId":"95dab4be-cb3c-4c31-8f70-b1751051a801","visualType":"markdownCard","markdownText":"This dashboard has been automatically generated for table public_transport, and can be accessible from the dashboard catalog at any point.\n\nYou can edit the dashboard, customize the visualizations and share with others.\n\nLearn more about Dashboards [here](https://learn.microsoft.com/en-us/azure/data-explorer/azure-data-explorer-dashboards)","visualOptions":{"pie__topNSlices":null}},{"id":"1758e58d-b48b-45c9-bcaa-6a2da0679bfa","title":"Row count","layout":{"x":0,"y":4,"width":4,"height":6},"pageId":"95dab4be-cb3c-4c31-8f70-b1751051a801","visualType":"card","queryRef":{"kind":"query","queryId":"c89cde76-2aef-4e49-865b-48d8f20f4dec"},"visualOptions":{"yAxisRight":false,"multiStat__textSize":"auto","multiStat__valueColumn":null,"colorRulesDisabled":false,"pie__topNSlices":null,"colorRules":[]}},{"id":"08b32412-7eab-4acc-b64f-70b9bcdc21f6","title":"Sample 100 rows","visualType":"table","pageId":"95dab4be-cb3c-4c31-8f70-b1751051a801","layout":{"x":0,"y":10,"width":16,"height":20},"queryRef":{"kind":"query","queryId":"a8e402d5-2fd7-4a75-90c4-9671dc5363d4"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"51b0eb18-3c91-49c8-935c-cb25f66ddf4d","title":"Map Vehicle Location","visualType":"map","pageId":"08a8986a-1909-4835-ba93-16c235e809be","layout":{"x":0,"y":0,"width":10,"height":7},"queryRef":{"kind":"query","queryId":"8a353209-469c-48c7-8834-52dd80cf923b"},"visualOptions":{"map__latitudeColumn":null,"map__longitudeColumn":null,"map__labelColumn":"tripId","map__sizeColumn":null,"map__sizeDisabled":false,"map__geoType":"numeric","map__geoPointColumn":null}},{"id":"b7ae53e8-253b-47dd-8cf8-ca670509048d","title":"New tile","visualType":"table","pageId":"08a8986a-1909-4835-ba93-16c235e809be","layout":{"x":0,"y":7,"width":24,"height":7},"queryRef":{"kind":"query","queryId":"c7d138c6-9de5-4260-94e7-dd80645eb9fd"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"67b2d33c-d48e-41c9-91d8-7369959cccb1","title":"Average Deviation from Schedule","visualType":"card","pageId":"08a8986a-1909-4835-ba93-16c235e809be","layout":{"x":10,"y":0,"width":6,"height":4},"queryRef":{"kind":"query","queryId":"290dc1c1-ab38-439d-987c-f8420e4b17ba"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":null,"colorRulesDisabled":false,"colorRules":[{"id":"60ac4e31-1801-41ae-8d84-38d7c68a4631","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":">","column":"avg_scheduleDeviation","values":["10"]}],"chainingOperator":"and","colorStyle":"bold","color":"red","tag":"","icon":"sad","ruleName":"","visualType":"card"},{"id":"06c8323a-fa79-46a4-876c-307c306137cd","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"<","column":"Column1","values":["10"]}],"chainingOperator":"and","colorStyle":"bold","color":"green","tag":"","icon":"happy","ruleName":"","visualType":"card"},{"id":"b0a3a6f1-6b24-4b53-ad0c-63f2f97dcf27","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"column":null,"operator":">","values":[""]}],"chainingOperator":"and","colorStyle":"bold","color":null,"tag":"","icon":null,"ruleName":"","visualType":"card"}]}}],"baseQueries":[{"id":"c8f7c966-1da4-4931-85fd-0cb286a3e18e","queryId":"92b71ac8-c981-4669-99d7-5d7ba99c0db7","variableName":"base_public_transit"}],"parameters":[{"kind":"duration","id":"e7a4fb2c-1a17-4699-b39e-2ea2c9b82aed","displayName":"Fetched At","description":"","beginVariableName":"fetched_at_sec_start","endVariableName":"fetched_at_sec_end","defaultValue":{"kind":"dynamic","count":15,"unit":"minutes"},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"fe2f79f5-12d4-4893-9620-3606fa2b24ed","name":"eh_public_transit","scopeId":"kusto-trident","kind":"kusto-trident","clusterUri":"https://trd-8je78swsfrtg7tfjp9.z7.kusto.fabric.microsoft.com","workspace":"253a31af-7442-450f-b93a-680a4831c265","database":"b2700bb9-57f0-47ea-81ef-e3c71edfb2de"}],"pages":[{"name":"Map","id":"08a8986a-1909-4835-ba93-16c235e809be"},{"name":"Data Stream Stats","id":"95dab4be-cb3c-4c31-8f70-b1751051a801"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"public_transport\n| extend ingestionTime = ingestion_time()\n| summarize count() by bin(ingestionTime, 5m)","id":"0af8d177-b5ac-4944-b15f-b62231db3899","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"public_transport | count","id":"c89cde76-2aef-4e49-865b-48d8f20f4dec","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"base_public_transit | take 100","id":"a8e402d5-2fd7-4a75-90c4-9671dc5363d4","usedVariables":["base_public_transit"]},{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"base_public_transit\n| project \n    lastKnownLong, \n    lastKnownLat, \n    vehicleId, \n    fetched_at_utc = bin(fetched_at_sec_utc, 1s),\n    tripId,\n    scheduleDeviation\n| render scatterchart with (kind = map)\n| where isnotnull( lastKnownLat) \nand lastKnownLat  != ''\nand lastKnownLat  != 0\nand fetched_at_utc between (fetched_at_sec_start .. fetched_at_sec_end)","id":"8a353209-469c-48c7-8834-52dd80cf923b","usedVariables":["base_public_transit","fetched_at_sec_end","fetched_at_sec_start"]},{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"\nbase_public_transit\n| where fetched_at_sec_utc between (fetched_at_sec_start .. fetched_at_sec_end)","id":"c7d138c6-9de5-4260-94e7-dd80645eb9fd","usedVariables":["base_public_transit","fetched_at_sec_end","fetched_at_sec_start"]},{"dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"base_public_transit\n| where fetched_at_sec_utc between (fetched_at_sec_start .. fetched_at_sec_end)\n| summarize avg(scheduleDeviation)/60\n","id":"290dc1c1-ab38-439d-987c-f8420e4b17ba","usedVariables":["base_public_transit","fetched_at_sec_end","fetched_at_sec_start"]},{"id":"92b71ac8-c981-4669-99d7-5d7ba99c0db7","dataSource":{"kind":"inline","dataSourceId":"fe2f79f5-12d4-4893-9620-3606fa2b24ed"},"text":"public_transport\n    | project\n    fetched_at_sec_utc = bin(fetched_at, 1s), //allows us to round to the nearest second\n    fetched_at_sec_pst = datetime_add(\"hour\", -8, bin(fetched_at, 1s)),\n    fetched_at_sec_cst = datetime_add(\"hour\", -6, bin(fetched_at, 1s)),\n    fetched_at_date = startofday(datetime_add(\"hour\", -8, bin(fetched_at, 1s))),\n    fetched_at_time = format_datetime(datetime(2000-01-01) + (datetime_add(\"hour\", -8, bin(fetched_at, 1s)) - startofday(datetime_add(\"hour\", -8, bin(fetched_at, 1s)))), \"h:mm:ss tt\"),\n    headSign = arrival_tripHeadsign,\n    vehicleId = arrival_vehicleId,\n    //stop info\n    totalStopsInTrip = arrival_totalStopsInTrip,\n    numberOfStopsAway = arrival_numberOfStopsAway,\n    stopSequence = arrival_stopSequence,\n    //geo data\n    lastKnownLat = arrival_tripStatus_lastKnownLocation_lat,\n    lastKnownLong = arrival_tripStatus_lastKnownLocation_lon,\n    positionLat = arrival_tripStatus_position_lat,\n    positionLong = arrival_tripStatus_position_lon,\n    //time stamps\n    predictedArrivalTime = unixtime_milliseconds_todatetime(arrival_predictedArrivalTime),\n    predictedDepartureTime = unixtime_milliseconds_todatetime(arrival_predictedDepartureTime),\n    scheduledDepartureTime = unixtime_milliseconds_todatetime(arrival_scheduledDepartureTime),\n    scheduledArrivalTime = unixtime_milliseconds_todatetime(arrival_scheduledArrivalTime),\n    statusLastUpdateTime = unixtime_milliseconds_todatetime(arrival_tripStatus_lastUpdateTime),\n    lastLocationUpdateTime = unixtime_milliseconds_todatetime(arrival_tripStatus_lastLocationUpdateTime),\n    lastUpdateDateTime = unixtime_milliseconds_todatetime(arrival_lastUpdateTime),\n    //statuses\n    arrival_status,\n    tripStatus = arrival_tripStatus_status,\n    //other\n    routeShortName = arrival_routeShortName,\n    scheduleDeviation = arrival_tripStatus_scheduleDeviation,\n    blockTripSequence = arrival_blockTripSequence,\n    statusBlockTripSequence = arrival_tripStatus_blockTripSequence,\n    nextStopTimeOffset = arrival_tripStatus_nextStopTimeOffset,\n    scheduledDistanceAlongTrip = arrival_tripStatus_scheduledDistanceAlongTrip,\n    totalDistanceAlongTrip = arrival_tripStatus_totalDistanceAlongTrip,\n    distanceAlongTrip = arrival_tripStatus_distanceAlongTrip,\n    phase = arrival_tripStatus_phase,\n    activeTripId = arrival_tripStatus_activeTripId,\n    distanceFromStop = arrival_distanceFromStop,\n    tripId = arrival_tripId,\n    routeId = arrival_routeId","usedVariables":[]}]}